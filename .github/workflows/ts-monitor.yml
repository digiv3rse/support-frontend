name: Typescript Monitor

on: [pull_request]

jobs:
    typescript_monitor:
        if: github.actor == 'scala-steward'
        name: Typescript Monitor
        defaults:
          run:
            working-directory: support-frontend
        runs-on: ubuntu-latest
        steps:

        - name: Checkout code
          uses: actions/checkout@v2

        - name: Install Node
          uses: guardian/actions-setup-node@main

        # Cache npm dependencies using https://github.com/bahmutov/npm-install
        - name: Cache dependencies
          uses: bahmutov/npm-install@v1
          with:
            working-directory: support-frontend

        - name: Check for new errors
          uses: guardian/typescript-monitor-action@main
          with:
            repo-token: '${{ secrets.GITHUB_TOKEN }}'
            cwd: './support-frontend'
            ts-script: 'yarn tsc --allowJs --noEmit'
            lint-script: 'yarn lint:check'
